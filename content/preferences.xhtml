<vbox id="zotero-prefpane-zoclau"
      xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
      xmlns:html="http://www.w3.org/1999/xhtml"
      flex="1">
  <script src="chrome://zotero/content/include.js"/>
  <script src="chrome://zoclau/content/preferences.js"/>

  <html:style>
    #zotero-prefpane-zoclau {
      --zc-bg: #f7f4ee;
      --zc-surface: #ffffff;
      --zc-border: #d7d0c5;
      --zc-text: #1f2937;
      --zc-muted: #5b6472;
      --zc-accent: #0f766e;
      --zc-danger: #9f1239;
      --zc-warning: #92400e;
      --zc-success: #0f766e;
      background: var(--zc-bg);
      color: var(--zc-text);
      padding: 14px;
    }

    #zotero-prefpane-zoclau .zc-shell {
      display: flex;
      flex-direction: column;
      gap: 12px;
      max-width: 980px;
    }

    #zotero-prefpane-zoclau .zc-hero {
      display: flex;
      align-items: center;
      gap: 12px;
      background: linear-gradient(135deg, #e9f7f4 0%, #fff4e8 100%);
      border: 1px solid var(--zc-border);
      border-radius: 12px;
      padding: 12px;
    }

    #zotero-prefpane-zoclau .zc-logo {
      width: 52px;
      height: 52px;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(15, 118, 110, 0.2);
      flex: 0 0 auto;
    }

    #zotero-prefpane-zoclau .zc-title {
      margin: 0;
      font-size: 20px;
      font-weight: 700;
      line-height: 1.15;
      color: #0b3d39;
    }

    #zotero-prefpane-zoclau .zc-subtitle {
      margin: 2px 0 0;
      font-size: 12px;
      color: var(--zc-muted);
    }

    #zotero-prefpane-zoclau groupbox.zc-card {
      border: 1px solid var(--zc-border);
      border-radius: 10px;
      background: var(--zc-surface);
      padding: 10px 12px;
      margin: 0;
      box-shadow: 0 1px 0 rgba(15, 23, 42, 0.03);
    }

    #zotero-prefpane-zoclau .zc-card-title {
      margin: 0 0 6px;
      font-size: 13px;
      font-weight: 700;
      color: var(--zc-accent);
    }

    #zotero-prefpane-zoclau .zc-card-note {
      margin: 0 0 10px;
      font-size: 11px;
      color: var(--zc-muted);
    }

    #zotero-prefpane-zoclau .zc-row {
      margin: 6px 0;
      align-items: center;
    }

    #zotero-prefpane-zoclau .zc-row-top {
      margin: 8px 0 6px;
      align-items: flex-start;
    }

    #zotero-prefpane-zoclau .zc-row-inline {
      margin: 8px 0 6px;
      gap: 14px;
      align-items: center;
    }

    #zotero-prefpane-zoclau .zc-label {
      width: 178px;
      margin-right: 8px;
      font-size: 12px;
      font-weight: 600;
      color: #374151;
    }

    #zotero-prefpane-zoclau textbox,
    #zotero-prefpane-zoclau menulist {
      min-height: 28px;
      border-radius: 6px;
    }

    #zotero-prefpane-zoclau textbox[multiline="true"] {
      min-height: 90px;
    }

    #zotero-prefpane-zoclau .zc-inline-status {
      display: block;
      margin: 4px 0 0 186px;
      font-size: 11px;
      color: var(--zc-muted);
      line-height: 1.35;
    }

    #zotero-prefpane-zoclau .zc-inline-status.is-ok {
      color: var(--zc-success);
    }

    #zotero-prefpane-zoclau .zc-inline-status.is-warn {
      color: var(--zc-warning);
    }

    #zotero-prefpane-zoclau .zc-inline-status.is-error {
      color: var(--zc-danger);
    }

    #zotero-prefpane-zoclau .zc-footer {
      font-size: 11px;
      color: var(--zc-muted);
      text-align: right;
      padding-right: 4px;
    }
  </html:style>

  <html:div class="zc-shell">
    <html:div class="zc-hero">
      <html:img class="zc-logo" src="chrome://zoclau/content/icons/zoclau-96.png" alt="Zoclau 图标" />
      <html:div>
        <html:h2 class="zc-title">Zoclau</html:h2>
        <html:p class="zc-subtitle">Zotero 内的 Claude 工作区助手</html:p>
      </html:div>
    </html:div>

    <groupbox class="zc-card">
      <label class="zc-card-title" value="Claude CLI 与运行目录" />

      <hbox class="zc-row" align="center">
        <label class="zc-label" value="CLI 路径" />
        <textbox id="zoclau-pref-clipath" flex="1" placeholder="自动检测（留空）" />
      </hbox>
      <label id="zoclau-pref-cli-status" class="zc-inline-status" value="" />

      <hbox class="zc-row" align="center">
        <label class="zc-label" value="工作目录" />
        <textbox id="zoclau-pref-workdir" flex="1" placeholder="默认：Zotero 配置目录" />
      </hbox>
      <label id="zoclau-pref-workdir-status" class="zc-inline-status" value="" />

      <hbox class="zc-row" align="center">
        <label class="zc-label" value="权限模式" />
        <menulist id="zoclau-pref-permission" flex="1">
          <menupopup>
            <menuitem label="YOLO（不提示）" value="yolo" />
            <menuitem label="安全（需要确认）" value="normal" />
            <menuitem label="计划（先探索）" value="plan" />
          </menupopup>
        </menulist>
      </hbox>
    </groupbox>

    <groupbox class="zc-card">
      <label class="zc-card-title" value="行为与安全" />
      <label class="zc-card-note" value="所有设置自动保存。" />

      <hbox class="zc-row-inline" align="center">
        <checkbox id="zoclau-pref-autoscroll" label="流式输出时自动滚动" native="true" />
        <checkbox id="zoclau-pref-load-user-settings" label="加载用户 Claude 设置（~/.claude/settings.json）" native="true" />
      </hbox>

      <hbox class="zc-row-top" align="start">
        <label class="zc-label" value="阻止的命令（Windows）" />
        <textbox id="zoclau-pref-blocked-cmd-win" multiline="true" rows="6" flex="1" />
      </hbox>

      <hbox class="zc-row-top" align="start">
        <label class="zc-label" value="阻止的命令（Unix/Git Bash）" />
        <textbox id="zoclau-pref-blocked-cmd-unix" multiline="true" rows="4" flex="1" />
      </hbox>
      <label id="zoclau-pref-blocklist-status" class="zc-inline-status" value="" />
    </groupbox>

    <label class="zc-footer" value="由 Zoclau 配置 · Zotero 工作区 AI" />
  </html:div>
</vbox>
